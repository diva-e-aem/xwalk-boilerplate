{"version":3,"file":"customtitle.js","sources":["../../src/blocks/customtitle/customtitle.ts"],"sourcesContent":["/* eslint-disable no-console */\nimport { html, nothing, render, TemplateResult } from 'lit';\n\nimport './customtitle.scss';\nimport { cleanUpBlock } from 'Utils/cleanUpBlock';\n// import { renderBlock } from 'Helpers/renderBlock';\n\n// const template = (text: string): TemplateResult => {\n//   return html`<h1>${text}</h1>`;\n// };\n\nfunction createAttributeMap(field: Element) {\n  const attributes = field.attributes;\n  return [...attributes]\n    .map(({ nodeName }) => nodeName)\n    .filter((attr) => attr.startsWith('data-aue-') || attr.startsWith('data-richtext-'))\n    .map((attribute) => {\n      return {\n        [attribute]: field.getAttribute(attribute),\n      };\n    });\n}\n\nfunction getDataForField(block: HTMLElement) {\n  return (propName: string) => {\n    const field = block.querySelector(`[data-aue-prop=\"${propName}\"]`);\n\n    return {\n      textContent: field?.textContent,\n      innerHTML: field?.innerHTML,\n      dataAttributes: field ? createAttributeMap(field) : null,\n    };\n  };\n}\n\ntype Props = {\n  titleText?: string | null;\n  titleAttributes?: Record<string, string>;\n};\n\nconst template = ({ titleText }: Props): TemplateResult | typeof nothing => {\n  if (!titleText) {\n    return nothing;\n  }\n\n  return html`\n    <div style=\"background: red\">\n      <h1>${titleText}</h1>\n    </div>\n  `;\n};\n\nexport default function (block: HTMLElement) {\n  const dataFetcher = getDataForField(block);\n  const { textContent: titleText, dataAttributes: titleAttributes } = dataFetcher('customTitle');\n  console.log('>>> 1', block);\n  console.log('>>> t p-tag', titleText);\n  console.log('>>> t p-attributes', titleAttributes);\n\n  const templateTarget = document.createElement('div');\n\n  cleanUpBlock(block);\n\n  render(template({ titleText }), templateTarget);\n\n  const h1 = templateTarget.querySelector('h1');\n  titleAttributes?.forEach((attr) => {\n    const key = Object.keys(attr)[0];\n    const value = attr[key];\n    console.log('>>> setKeyValue', key, value);\n    if (!value) return;\n    h1?.setAttribute(key, value);\n  });\n\n  block.innerHTML = templateTarget.innerHTML;\n\n  // const textElement = block.children[0].children[0];\n\n  // renderBlock({\n  //   template: template(text),\n  //   container: block,\n  //   moveInstrumentationsOptions: {\n  //     from: textElement,\n  //     to: block.querySelector('h1') as Element,\n  //   },\n  // });\n\n  // console.log('>>> render finished', block);\n  // Array.from(attributes).forEach((attr) => {\n  //   const value = block.querySelector('p')!.getAttribute(attr);\n  //   if (value) {\n  //     to.setAttribute(attr, value);\n  //     from.removeAttribute(attr);\n  //   }\n  // });\n}\n"],"names":["createAttributeMap","field","nodeName","attr","attribute","getDataForField","block","propName","template","titleText","html","nothing","customtitle","dataFetcher","titleAttributes","templateTarget","cleanUpBlock","render","h1","key","value"],"mappings":"mIAWA,SAASA,EAAmBC,EAAgB,CAEnC,MAAA,CAAC,GADWA,EAAM,UACJ,EAClB,IAAI,CAAC,CAAE,SAAAC,KAAeA,CAAQ,EAC9B,OAAQC,GAASA,EAAK,WAAW,WAAW,GAAKA,EAAK,WAAW,gBAAgB,CAAC,EAClF,IAAKC,IACG,CACL,CAACA,CAAS,EAAGH,EAAM,aAAaG,CAAS,CAAA,EAE5C,CACL,CAEA,SAASC,EAAgBC,EAAoB,CAC3C,OAAQC,GAAqB,CAC3B,MAAMN,EAAQK,EAAM,cAAc,mBAAmBC,CAAQ,IAAI,EAE1D,MAAA,CACL,YAAaN,GAAA,YAAAA,EAAO,YACpB,UAAWA,GAAA,YAAAA,EAAO,UAClB,eAAgBA,EAAQD,EAAmBC,CAAK,EAAI,IAAA,CACtD,CAEJ,CAOA,MAAMO,EAAW,CAAC,CAAE,UAAAC,KACbA,EAIEC,oCAEGD,CAAS,cALVE,EAUX,SAAAC,EAAyBN,EAAoB,CACrC,MAAAO,EAAcR,EAAgBC,CAAK,EACnC,CAAE,YAAaG,EAAW,eAAgBK,GAAoBD,EAAY,aAAa,EACrF,QAAA,IAAI,QAASP,CAAK,EAClB,QAAA,IAAI,cAAeG,CAAS,EAC5B,QAAA,IAAI,qBAAsBK,CAAe,EAE3C,MAAAC,EAAiB,SAAS,cAAc,KAAK,EAEnDC,EAAaV,CAAK,EAElBW,EAAOT,EAAS,CAAE,UAAAC,CAAU,CAAC,EAAGM,CAAc,EAExC,MAAAG,EAAKH,EAAe,cAAc,IAAI,EAC3BD,GAAA,MAAAA,EAAA,QAASX,GAAS,CACjC,MAAMgB,EAAM,OAAO,KAAKhB,CAAI,EAAE,CAAC,EACzBiB,EAAQjB,EAAKgB,CAAG,EACd,QAAA,IAAI,kBAAmBA,EAAKC,CAAK,EACpCA,IACDF,GAAA,MAAAA,EAAA,aAAaC,EAAKC,GAAK,GAG7Bd,EAAM,UAAYS,EAAe,SAqBnC"}